# Dantzig-Wolfe Decomposition

*参考自：https://space.bilibili.com/696855224

## 基本介绍

### 算法引出

Dantzig-Wolfe分解算法是以George Dantzig和Philp Wolfe的名字命名的。DW分解算法是借助拉格朗日松弛方法，将大量的复杂约束与一个或者多个具有易处理的特殊结构的线性约束分解开。

分解得到的子问题通常具备分块对角结构(block-diagonal)，分块之间相互独立并只包含一部分决策变量。

每个分块对应对应的子问题可能仅仅只是反映了一个组织内部的部分单元、部分时间周期或者其他小规模的模块，它们只是通过一系列的链接约束(linking constraints)与其他子问题联系在一起。

### 算法基本原理

DW分解算法的基本思想是利用子问题具有易处理的结构特点，将一个整体问题分解为一个限制记住问题和一个或者一系列子问题。

(1). RLMP，限制主问题是一个受限制的原问题的近似问题，它通过列生成算法不断扩展，并逐渐提高对原问题的近似程度。

(2). Sub-Problem，子问题负责提供必要的信息，协助主问题逐步提高对原问题的近似程度，并收敛到原问题的最优解。

#### 分解机制

对于这种存在block-diagonal结构的问题，有一种特殊的处理方法，叫做Dantzig-Wolfe分解。

这个方法的基本出发点是把原问题P中的变量进行改写，任何一个变量都可以写成一些定点的集合，然后再用列生成的方法来生成一个个的顶点。

**而变量改写的过程，其实就是把原来的变量用多面体集合的顶点凸组合和极方向锥组合来重写，而需要用到的顶点数量级非常大，这个时候就需要借鉴列生成的思想，虽然有很多顶点，但是可能并不需要这么多顶点。**

DW分解与CG关系非常紧密，两者往往是可以交互的，有点像从不同的角度去看待同一个问题，DW是从顶点的角度，CG是从列的角度。

## 数学模型

$$
\begin{aligned}
 P = \min &  (c^1)^Tx^1 +   & (c^2)^Tx^2 +  & \cdots  + &  (c^k)^Tx^k   &\\
 s.t. &  A^1 x^1 +      & A^2 x^2 +     & \cdots +  &   A^k x^k     &= b  \\
      & D^1 x^1         &               &           &               &\leq d_1 \\
      &                 & D^2 x^2       &           &               &\leq d_2 \\
      &                 &               & \cdots    &               & \\
      &                 &               &           & D^k x^k       & \leq d_k\\
\end{aligned}
$$,


其中，$\sum_{i}A^ix^i = b$为难处理的约束，也称之为耦合约束，而剩下约束称之为容易处理的约束。


假设我们去掉第一个约束，那么该问题P剩下的约束条件，每个子系统需要完成的决策$x$其实是相互独立的，而且目标函数也是k个子系统的线性组合，在这种情况下，这个问题是可以被分解的，分解成k个min问题，每个min问题对一个子系统求解。

子问题往往是容易处理的，约束条件可以当做是背包约束，再加上一个线性目标函数，可以当做背包问题来求解，使用动态规划算法。


### 拉格朗日松弛

按照上述章节描述，第一个约束是个难处理的约束，因为这个约束的存在，$x^1, \cdots, x^k$等不能互相独立。如果我们对第一个约束做拉格朗日松弛，整理后，原问题被松弛为一个个子系统的线性组合，那么获得原问题P的拉个朗日松弛问题LD(P)问题。

$$
\begin{aligned}
 LD(P) = \min & \sum_{k=1}^{K} ((c^k)^T-\lambda^TA^k)x^k &&+ \lambda^T b&& \\
 s.t. & D^1 x^1         &               &           &               &\leq d_1 \\
      &                 & D^2 x^2       &           &               &\leq d_2 \\
      &                 &               & \cdots    &               & \\
      &                 &               &           & D^k x^k       & \leq d_k\\
      &    x^1\in Z_{+}^{n_1}            &      \cdots         &           &   x^k\in Z_{+}^{n_k}      & \\
\end{aligned}
$$,

### LD(P)问题的等价变换

LD(P)问题可以表示为：

$$
\begin{aligned}
 LD(P) = \min & \sum_{k=1}^{K} (c^k)^Tx^k &  \\
 s.t. & \sum_{k=1}^{K} (A^k)^Tx^k & = b \\
       &  x^k \in X^k=\{x^k \in Z^{n_k}| D^kx^k \leq d_k \}
\end{aligned}
$$,


### IPM问题的引出

假设$X^k$是一个有界的多面体，$X^k$中的任一点都可以写成顶点的凸组合(假设所有顶点都是已知的)。

假设我们可以找到所有$x^k$通过可行域的顶点的凸组合，那么对LP(D)进行改写，模型如下：

$$
\begin{aligned}
 IPM = \min & \sum_{k=1}^{K} (c^k)^T \sum_{t=1}^{T_k} \lambda_{kt}x^{kt}  &  \\
 s.t. & \sum_{k=1}^{K} (A^k)^T \sum_{t=1}^{T_k} \lambda_{kt}x^{kt} & = b \\
       & \sum_{t=1}^{T_k} \lambda_{kt}x^{kt} = 1 \\
       & \lambda_{kt} \in \{0, 1\}, \forall k, t  \\
\end{aligned}
$$,

这个替换后的问题叫做IPM问题，也就是IP master problems， IP主问题。

**在这个IPM中，假设所有的$x^{kt}$都是已知的，要么是多面体的所有顶点，要么是整数集合中的所有整数元素。**

*注意这里的IPM与P是完全等价的，只是变量换了形式，原来是整数规划问题，现在是0-1变量问题。*



